// You need to create a fresh new google doc and click on the Extensions option and then click Apps Script

// Once your on the untitled project go ahead and copy and paste this script into the Code.gs





function onOpen() {
  DocumentApp.getUi().createMenu('Script Run')
    .addItem('IDE-Ware', 'showDialog')
    .addToUi();
}

function showDialog() {
  var htmlOutput = HtmlService.createHtmlOutputFromFile('Page')
      .setWidth(1000)
      .setHeight(1000);
  DocumentApp.getUi().showModalDialog(htmlOutput, 'IDE-Ware');
}

function getScriptContent() {
  return UrlFetchApp.fetch('https://cdn.jsdelivr.net/gh/FinalRuze/qweeq@main/index.html').getContentText();
}



// Next you need click the little plus sign above the Code.gs and then click HTML

// once you have done that just name it Page.html and paste this code into the Page.html





<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body {
        background-color: black;
        color: white;
        font-family: Arial, sans-serif;
      }

      .gradient-button {
        background: linear-gradient(to right, #2b036f, #eb549b);
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <button onclick="copyToClipboard()" class="gradient-button">Copy Script</button>
    <button onclick="showScriptInIframe()" class="gradient-button">Show Script</button>
    <button onclick="runScript()" class="gradient-button">Run in Iframe</button>
    <button onclick="toggleFullscreen()" class="gradient-button">Fullscreen Iframe</button>
    <button onclick="runScriptInWindow()" class="gradient-button">Separate Tab</button>

    <br><br>
    
    <iframe id="scriptFrame" width="100%" height="500px" frameborder="0"></iframe>
    <pre id="scriptText" style="display: none; white-space: pre-wrap;"></pre>

    <script>
      function copyToClipboard() {
        google.script.run.withSuccessHandler(function(scriptContent) {
          var textarea = document.createElement('textarea');
          textarea.value = scriptContent;

          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand('copy');
          document.body.removeChild(textarea);

          alert('Script content copied to clipboard!');
        }).getScriptContent();
      }

      function runScript() {
        google.script.run.withSuccessHandler(function(scriptContent) {
          document.getElementById('scriptFrame').style.display = 'block';
          document.getElementById('scriptFrame').srcdoc = scriptContent;
          document.getElementById('scriptText').style.display = 'none';
        }).getScriptContent();
      }

      function runScriptInWindow() {
        google.script.run.withSuccessHandler(function(scriptContent) {
          var newWindow = window.open();
          newWindow.document.write(scriptContent);
        }).getScriptContent();
      }

      function toggleFullscreen() {
        var iframe = document.getElementById('scriptFrame');
        if (iframe.requestFullscreen) {
          iframe.requestFullscreen();
        } else if (iframe.mozRequestFullScreen) { 
          iframe.mozRequestFullScreen();
        } else if (iframe.webkitRequestFullscreen) { 
          iframe.webkitRequestFullscreen();
        } else if (iframe.msRequestFullscreen) { 
          iframe.msRequestFullscreen();
        }
      }

      function showScriptInIframe() {
        google.script.run.withSuccessHandler(function(scriptContent) {
          document.getElementById('scriptFrame').style.display = 'none';
          document.getElementById('scriptText').innerText = scriptContent;
          document.getElementById('scriptText').style.display = 'block';
        }).getScriptContent();
      }
    </script>
  </body>
</html>



                                    

// Once that is done you can click Save project (its right next to the Execution log in the shape of a floppy disk)

// Once saved just reload the google doc and there should be an option right next to Accessibilty that says Script Run

// When trying to run it will say it requires certain permissions

// Just click Advanced and proceed with the execution (might want to run it again)
